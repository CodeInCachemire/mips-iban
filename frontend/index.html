<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IBAN ↔ KNR / BLZ Calculator</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>

  <!--  Top Bar  -->
  <header class="topbar">
    <div class="topbar-left">
      <h1>MIPS Assembly German IBAN Validator & Generator</h1>
      <span class="badge">CI VERIFIED</span>
    </div>
    <div class="topbar-right">
      <a href="/static/history.html" class="topbar-link history-link" style="font-size: 16px; font-weight: 500; text-decoration: underline;">Conversion History</a>
      <span class="meta" style="font-size: 16px;">MIPS Assembly • FastAPI • Docker • SQLite • AWS</span>
    </div>
  </header>

  <!--  Main Dashboard  -->
  <main class="dashboard">

      <!-- LEFT COLUMN -->
      <div class="left-column">

      <!-- Calculator Card -->
        <section class="card calculator-card">
          <h2>Choose between Validator or Generator mode!</h2>
          <p class="card-subtitle">Convert between a valid german IBAN and its underlying German banking identifiers BLZ and KNR.</p>
          <p class="card-subtitle">You may use your german debit card for the KNR and BLZ values to get a valid IBAN.</p>
          <p class="card-subtitle">Sensitive identifiers are masked before persistence for the conversion history database.</p>

          <div class="mode-buttons">
            <button id="btn-iban" class="active" onclick="selectMode('IBAN')">
              IBAN → KNR + BLZ
            </button>
            <button id="btn-knrblz" onclick="selectMode('KNRBLZ')">
              KNR + BLZ → IBAN
            </button>
          </div>

          <div class="form">
            <label for="value1" id="label-value1">IBAN (22 digits)</label>
            <input id="value1" type="text" placeholder="DE02120300000000202051" />

            <label for="value2" id="label-value2" class="disabled">
              BLZ (8 digits)
            </label>
            <input id="value2" type="text" placeholder="12030000" disabled />

            <button class="run-btn" onclick="run()">Convert</button>
          </div>

          <div id="spinner" class="spinner hidden"></div>
          <pre id="output"></pre>
        </section>

      <!-- CI Card -->
      <section class="card ci-card">
        <h2>Continuous Integration</h2>
        <pre class="ci-log">
        <span class="ci-test">test_iban_to_knr_blz</span> ... <span class="ci-pass">PASSED</span>
        <span class="ci-test">test_knr_blz_to_iban</span> ... <span class="ci-pass">PASSED</span>
        <span class="ci-test">test_invalid_iban</span> ... <span class="ci-pass">PASSED</span>
        <span class="ci-test">test_invalid_knr_blz</span> ... <span class="ci-pass">PASSED</span>
        <span class="ci-test">test_validateChecksum</span> ... <span class="ci-pass">PASSED</span>

        <span class="ci-footer">✔ All MIPS tests passed via GitHub CI.</span>
        <span class="ci-footer">✔ All Python frontend tests passed via GitHub CI.</span>
        <span class="ci-footer">✔ All Python backend tests passed via GitHub CI.</span>
        </pre>
        </section>

      </div>

      <!-- RIGHT COLUMN -->
      <section class="card info-card">
        <h2>About This Tool</h2>

        <p class="about-lead">
          A verified implementation of a German IBAN validator and generator,
          built on deterministic MIPS execution. Now extended and exposed via a modern web API.
        </p>

        <div class="about-block">
          <h3>Implementation</h3>
          <ul class="impl-list">
            <li>Initial MIPS assembly implementation 2023</li>
              <ul>
                <li>Written in MIPS assembly language</li>
                <li>Executed via MARS simulator</li>
                <li>Verified via local test suite</li>
              </ul>
            <li>Extension Phase 1 2025</li>
            <ul>
              <li>FastAPI backend as a thin execution and validation layer</li>
              <li>Dockerized MIPS environment for reproducible execution</li>
              <li>Automated test suite executed in GitHub CI</li>
            </ul>
            <li>Extension Phase 2 2025</li>
            <ul>
              <li>MIPS core IBAN extended, validation in IBAN to KNRBLZ mode</li>
              <li>Implemented persistent conversion history backed by SQLite</li>
              <li>Added structured logging alongside backend input validation</li>
              <li>Deployed to AWS</li>
            </ul>
          </ul>
        </div>

        <div class="about-block">
          <h3>German IBAN format</h3>
          <p>
            An IBAN (International Bank Account Number) uniquely identifies a bank
            account and embeds a checksum to detect input errors.
          </p>

          <pre class="iban-format">DE AA BBBBBBBB CCCCCCCCCC</pre>

          <ul class="iban-parts">
            <li><strong>DE</strong> — country code</li>
            <li><strong>AA</strong> — checksum digits</li>
            <li><strong>BBBBBBBB</strong> — BLZ (bank code)</li>
            <li><strong>CCCCCCCCCC</strong> — KNR (account number)</li>
          </ul>
        </div>

        <div class="about-block">
          <h3>Conversion modes</h3>

          <div class="mode-block">
            <strong>Validator Mode: IBAN → KNR + BLZ</strong>
            <p>
              Parses a German IBAN, validates it via verify_iban and then extracts the embedded BLZ and KNR.
              It uses validate_checksum.
            </p>
            <strong>verify_iban, validate_checksum, iban2knr.asm</strong>
          </div>

          <div class="mode-block">
            <strong>Generator Mode: KNR + BLZ → IBAN</strong>
            <p>
              Validates the inputs, computes the checksum using string-based
              modulo arithmetic, and outputs a fully valid German IBAN.
            </p>
            <strong>knr2iban.asm, moduloStr.asm, validateChecksum.asm</strong>
          </div>
        </div>
      </section>

  </main>

  <script src="/static/script.js"></script>
</body>
</html>
